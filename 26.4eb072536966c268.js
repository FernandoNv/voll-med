"use strict";(self.webpackChunkvoll_med=self.webpackChunkvoll_med||[]).push([[26],{2026:(it,P,o)=>{o.r(P),o.d(P,{PatientsModule:()=>h});var r=o(6895),d=o(3060),f=o(3900),g=o(5698),x=o(9300),e=o(4650),C=o(7579),A=o(5625),y=o(4004),$=o(1005),Z=o(3151),w=o(2340),Y=o(529),S=o(3737);const B=w.N.apiUrl;class c{constructor(t,n){this.httpClient=t,this.phonePipe=n,this.baseUrl=`${B}/api/v1/pacientes`,this.loadingSubject$=new C.x}loading(){return this.loadingSubject$.asObservable()}getPatients(){this.loadingSubject$.next(!0);const t=this.httpClient.get(this.baseUrl).pipe((0,A.X)(3),(0,y.U)(n=>n.content),(0,$.g)(500),(0,Z.d)());return t.subscribe(()=>this.loadingSubject$.next(!1)),t}newPatient(t){return this.httpClient.post(this.baseUrl,t)}updateById(t){return this.httpClient.put(this.baseUrl,t)}getPatientById(t){return this.httpClient.get(`${this.baseUrl}/${t}`)}deactivateAccountById(t){return this.httpClient.delete(`${this.baseUrl}/${t}`)}formatTextModal(t){return[this.phonePipe.transform(t.telefone??""),t.cpf]}}c.\u0275fac=function(t){return new(t||c)(e.LFG(Y.eN),e.LFG(S.E))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"});var M=o(8945),O=o(4283);function E(a,t){if(1&a){const n=e.EpF();e.TgZ(0,"app-registration-form",2),e.NdJ("form-values-emitter",function(s){e.CHM(n);const p=e.oxw();return e.KtG(p.onSubmit(s))})("deactivate-account-emitter",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.onDeactivateButtonClicked())}),e.qZA()}if(2&a){const n=t.ngIf,i=e.oxw();e.Q6J("form-options",i.buildFormOptions(n))("update",!0)}}class m{constructor(t,n,i,s,p){this.patientsService=t,this.router=n,this.ativatedRoute=i,this.location=s,this.deactivateAccountPopupService=p,this.patient$=this.ativatedRoute.paramMap.pipe((0,f.w)(ot=>(this.idPatient=Number(ot.get("id")),this.patientsService.getPatientById(this.idPatient))))}buildFormOptions(t){return{type:"patient",inputValues:{nome:t.nome,cpf:t.cpf,email:t.email,telefone:t.telefone??"",logradouro:t.endereco?.logradouro??"",numero:t.endereco?.numero??"",uf:t.endereco?.uf??"",complemento:t.endereco?.complemento??"",cidade:t.endereco?.cidade??"",cep:t.endereco?.cep??"",bairro:t.endereco?.bairro??""}}}onSubmit(t){console.log("submit ",t),this.patientsService.updateById({id:this.idPatient,nome:t.nome,telefone:t.telefone,endereco:{logradouro:t.logradouro,bairro:t.bairro,cidade:t.cidade,cep:t.cep,numero:t.numero,complemento:t.complemento,uf:t.uf}}).pipe((0,g.q)(1)).subscribe({next:()=>{this.message="Dados atualizados com sucesso",this.success=!0,setTimeout(()=>{this.location.back()},1e3)},error:()=>{this.message="Erro ao atualizar os dados",this.success=!1}})}onDeactivateButtonClicked(){this.patientsService.getPatientById(this.idPatient).pipe((0,g.q)(1),(0,f.w)(n=>{const i={informationName:n.nome,informationText:this.patientsService.formatTextModal(n)};return this.deactivateAccountPopupService.open(i)})).pipe((0,x.h)(n=>!0===n),(0,f.w)(n=>this.patientsService.deactivateAccountById(this.idPatient))).subscribe({next:n=>{this.router.navigate(["/patients"])},error:n=>{console.log("Erro with the deactivation"),console.log(n),this.deactivateAccountPopupService.open()}})}}m.\u0275fac=function(t){return new(t||m)(e.Y36(c),e.Y36(d.F0),e.Y36(d.gz),e.Y36(r.Ye),e.Y36(M.I))},m.\u0275cmp=e.Xpm({type:m,selectors:[["app-edit-patient"]],decls:3,vars:3,consts:[[1,"app-patient-edit"],[3,"form-options","update","form-values-emitter","deactivate-account-emitter",4,"ngIf"],[3,"form-options","update","form-values-emitter","deactivate-account-emitter"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,E,1,2,"app-registration-form",1),e.ALo(2,"async"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,n.patient$)))},dependencies:[r.O5,O.Q,r.Ov]});class l{constructor(t,n){this.location=t,this.patientsService=n}ngOnInit(){this.formOptions={type:"patient"}}onSubmit(t){const n={nome:t.nome,telefone:t.telefone,email:t.email,cpf:t.cpf,endereco:{logradouro:t.logradouro,bairro:t.bairro,cidade:t.cidade,cep:t.cep,numero:t.numero,complemento:t.complemento,uf:t.uf}};console.log("submit ",n),this.patientsService.newPatient(n).pipe((0,g.q)(1)).subscribe({next:()=>{console.log("Dados salvos com sucesso"),setTimeout(()=>{this.location.back()},1e3)},error:i=>{console.log("Erro ao cadastrar os dados ",i)}})}}l.\u0275fac=function(t){return new(t||l)(e.Y36(r.Ye),e.Y36(c))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-new-patient"]],decls:2,vars:1,consts:[[1,"app-new-patient"],[3,"form-options","form-values-emitter"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"app-registration-form",1),e.NdJ("form-values-emitter",function(s){return n.onSubmit(s)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("form-options",n.formOptions))},dependencies:[O.Q]});var N=o(2722),b=o(8061),I=o(1572),T=o(4859),F=o(9267);function J(a,t){1&a&&(e.TgZ(0,"div",3),e._UZ(1,"mat-spinner",4),e.qZA())}function U(a,t){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"app-list-expansion-panel",9),e.NdJ("edit-button-clicked",function(s){e.CHM(n);const p=e.oxw(3);return e.KtG(p.onEditButtonClicked(s))})("deactivate-button-clicked",function(s){e.CHM(n);const p=e.oxw(3);return e.KtG(p.onDeactivateButtonClicked(s))}),e.qZA()()}if(2&a){const n=e.oxw().ngIf;e.xp6(1),e.Q6J("items",n)}}const j=function(){return["/patients/new"]};function Q(a,t){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,U,2,1,"div",6),e.TgZ(2,"div",7)(3,"button",8),e._uU(4," Cadastrar novo perfil "),e.qZA()()()),2&a){const n=t.ngIf;e.oxw();const i=e.MAs(4);e.xp6(1),e.Q6J("ngIf",n.length>0)("ngIfElse",i),e.xp6(2),e.Q6J("routerLink",e.DdM(3,j))}}function _(a,t){1&a&&(e.TgZ(0,"div",10)(1,"p"),e._uU(2,"Sem pacientes cadastrados..."),e.qZA()())}function L(a,t){if(1&a&&(e.TgZ(0,"span"),e.YNc(1,Q,5,4,"div",2),e.ALo(2,"async"),e.YNc(3,_,3,0,"ng-template",null,5,e.W1O),e.qZA()),2&a){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,n.items$))}}class u{constructor(t,n,i,s){this.patientsService=t,this.router=n,this.deactivateAccountPopupService=i,this.cpfPipe=s,this.destroySubject$=new C.x,this.patientsService.loading().pipe((0,N.R)(this.destroySubject$)).subscribe(p=>{this.isLoading=p})}ngOnInit(){this.setItems()}ngOnDestroy(){this.destroySubject$.next(!0),this.destroySubject$.complete()}setItems(){this.patients$=this.patientsService.getPatients(),this.items$=this.patients$.pipe((0,y.U)(t=>this.mapperToItems(t)))}mapperToItems(t){return t.map(i=>({id:i.id,title:i.nome,description:`${this.cpfPipe.transform(i.cpf)}`,content:[i.email]}))}onEditButtonClicked(t){this.router.navigate(["/patients/edit",t])}onDeactivateButtonClicked(t){this.patientsService.getPatientById(t).pipe((0,g.q)(1),(0,f.w)(i=>{i.cpf=this.cpfPipe.transform(i.cpf);const s={informationName:i.nome,informationText:this.patientsService.formatTextModal(i)};return this.deactivateAccountPopupService.open(s)})).pipe((0,x.h)(i=>!0===i),(0,f.w)(i=>this.patientsService.deactivateAccountById(t))).subscribe({next:i=>{this.setItems()},error:i=>{console.log("Erro with the deactivation"),console.log(i),this.deactivateAccountPopupService.open()}})}}u.\u0275fac=function(t){return new(t||u)(e.Y36(c),e.Y36(d.F0),e.Y36(M.I),e.Y36(b.Q))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-patients"]],decls:3,vars:2,consts:[[1,"app-patients"],["class","spinner-area",4,"ngIf"],[4,"ngIf"],[1,"spinner-area"],["diameter","40"],["noItems",""],[4,"ngIf","ngIfElse"],[1,"actions-area"],["mat-flat-button","",3,"routerLink"],[3,"items","edit-button-clicked","deactivate-button-clicked"],[1,"no-content-area"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,J,2,0,"div",1),e.YNc(2,L,5,3,"span",2),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.isLoading),e.xp6(1),e.Q6J("ngIf",!n.isLoading))},dependencies:[r.O5,d.rH,I.Ou,T.lW,F.e,r.Ov],styles:[".app-patients[_ngcontent-%COMP%]{width:100%}@media (min-width: 640px){.app-patients[_ngcontent-%COMP%]{max-width:640px}}@media (min-width: 768px){.app-patients[_ngcontent-%COMP%]{max-width:768px}}@media (min-width: 1024px){.app-patients[_ngcontent-%COMP%]{max-width:1024px}}@media (min-width: 1280px){.app-patients[_ngcontent-%COMP%]{max-width:1280px}}@media (min-width: 1536px){.app-patients[_ngcontent-%COMP%]{max-width:1536px}}.app-patients[_ngcontent-%COMP%]{height:100%}.app-patients[_ngcontent-%COMP%]   .spinner-area[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column;align-items:center;justify-content:center}.app-patients[_ngcontent-%COMP%]   .actions-area[_ngcontent-%COMP%]{display:flex;height:auto;flex-direction:row;justify-content:center;padding-top:3rem;padding-bottom:1.5rem}.app-patients[_ngcontent-%COMP%]   .actions-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:.75rem;font-size:1rem;line-height:1.5rem;font-weight:700;padding:24px!important;background-color:#0b3b60!important;color:#fff}.app-patients[_ngcontent-%COMP%]   .no-content-area[_ngcontent-%COMP%]{padding:1rem;--tw-text-opacity: 1;color:rgb(71 85 105 / var(--tw-text-opacity))}"]});const D=[{path:"",pathMatch:"full",component:u,title:"Pacientes"},{path:"new",component:l,title:"Cadastrar"},{path:"edit/:id",component:m,title:"Editar"}];class v{}v.\u0275fac=function(t){return new(t||v)},v.\u0275mod=e.oAB({type:v}),v.\u0275inj=e.cJS({imports:[d.Bz.forChild(D),d.Bz]});var z=o(2095),G=o(5106),R=o(4466),H=o(1458),X=o(4980),K=o(4006),W=o(9549),k=o(4144),q=o(4385);const V=[I.Cq,W.lN,T.ot,k.c,q.LD],tt=[r.ez,v,K.UX],et=[G.k,R.m,H.x,X.v],nt=[S.E,z.q,b.Q];class h{}h.\u0275fac=function(t){return new(t||h)},h.\u0275mod=e.oAB({type:h}),h.\u0275inj=e.cJS({providers:[...nt],imports:[tt,V,et]})}}]);